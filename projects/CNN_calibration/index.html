<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Calibration of Convolutional Neural Networks (CNNs) using Temperature Scaling | Mario Golbano Corzo </title> <meta name="author" content="Mario Golbano Corzo"> <meta name="description" content="Exploring the calibration of CNNs through temperature scaling to improve model reliability in binary classification tasks."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/brain_NN.png?5f79de3f26919cdb48021f2c2b8215e4"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://mariogolbano.github.io/projects/CNN_calibration/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Mario</span> Golbano Corzo </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">Projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Calibration of Convolutional Neural Networks (CNNs) using Temperature Scaling</h1> <p class="post-description">Exploring the calibration of CNNs through temperature scaling to improve model reliability in binary classification tasks.</p> </header> <article> <h2 id="abstract">Abstract</h2> <p>This project investigates the calibration of Convolutional Neural Networks (CNNs) using temperature scaling to enhance their reliability in binary classification tasks. The project primarily focuses on understanding how well a CNN’s predicted probabilities align with actual outcomes through calibration metrics like <strong>Expected Calibration Error (ECE)</strong> and <strong>reliability diagrams</strong>.</p> <p>Two models were used to achieve these objectives:</p> <ol> <li> <strong>LeNet-5</strong>: A simple CNN architecture trained from scratch.</li> <li> <strong>DenseNet-121</strong>: A more complex pre-trained model, fine-tuned for binary classification.</li> </ol> <p>Both models were trained on the <strong>CIFAR-10 dataset</strong>, filtered to include only images of <strong>birds</strong> and <strong>cats</strong>. The calibration process was evaluated through <strong>reliability diagrams</strong> and <strong>ECE calculations</strong>, showing significant improvements after applying <strong>temperature scaling</strong>.</p> <hr> <h2 id="model-descriptions">Model Descriptions</h2> <h3 id="model-1-lenet-5">Model 1: LeNet-5</h3> <p>The <strong>LeNet-5</strong> model was adapted for binary classification to distinguish between cats and birds in the CIFAR-10 dataset. The architecture was modified to include <strong>dropout layers</strong> and <strong>batch normalization</strong> for better performance.</p> <h4 id="key-layers">Key Layers:</h4> <ul> <li>Two convolutional layers with ReLU activation.</li> <li>Two max-pooling layers.</li> <li>Three fully connected layers with a <strong>sigmoid activation</strong> for binary classification.</li> </ul> <div style="display: flex; justify-content: center;"> <table style="border-collapse: collapse; width: 60%; text-align: center;"> <thead> <tr> <th style="border: 1px solid #ddd; padding: 8px;">Layer Type</th> <th style="border: 1px solid #ddd; padding: 8px;">Output Shape</th> <th style="border: 1px solid #ddd; padding: 8px;">Activation Function</th> </tr> </thead> <tbody> <tr> <td style="border: 1px solid #ddd; padding: 8px;">Conv Layer 1</td> <td style="border: 1px solid #ddd; padding: 8px;">(6, 28, 28)</td> <td style="border: 1px solid #ddd; padding: 8px;">ReLU</td> </tr> <tr> <td style="border: 1px solid #ddd; padding: 8px;">Max Pooling Layer 1</td> <td style="border: 1px solid #ddd; padding: 8px;">(6, 14, 14)</td> <td style="border: 1px solid #ddd; padding: 8px;">-</td> </tr> <tr> <td style="border: 1px solid #ddd; padding: 8px;">Conv Layer 2</td> <td style="border: 1px solid #ddd; padding: 8px;">(16, 10, 10)</td> <td style="border: 1px solid #ddd; padding: 8px;">ReLU</td> </tr> <tr> <td style="border: 1px solid #ddd; padding: 8px;">Max Pooling Layer 2</td> <td style="border: 1px solid #ddd; padding: 8px;">(16, 5, 5)</td> <td style="border: 1px solid #ddd; padding: 8px;">-</td> </tr> <tr> <td style="border: 1px solid #ddd; padding: 8px;">Fully Connected 1</td> <td style="border: 1px solid #ddd; padding: 8px;">120</td> <td style="border: 1px solid #ddd; padding: 8px;">ReLU</td> </tr> <tr> <td style="border: 1px solid #ddd; padding: 8px;">Fully Connected 2</td> <td style="border: 1px solid #ddd; padding: 8px;">84</td> <td style="border: 1px solid #ddd; padding: 8px;">ReLU</td> </tr> <tr> <td style="border: 1px solid #ddd; padding: 8px;">Output Layer</td> <td style="border: 1px solid #ddd; padding: 8px;">1</td> <td style="border: 1px solid #ddd; padding: 8px;">Sigmoid</td> </tr> </tbody> </table> </div> <p>The model’s performance was evaluated using:</p> <ul> <li><strong>Accuracy</strong></li> <li><strong>Reliability Diagrams</strong></li> <li><strong>Expected Calibration Error (ECE)</strong></li> </ul> <hr> <h3 id="model-2-densenet-121">Model 2: DenseNet-121</h3> <p>In addition to LeNet-5, the project also explores <strong>DenseNet-121</strong>, a <strong>pre-trained model</strong> from the torchvision library, fine-tuned for binary classification.</p> <p>Key modifications:</p> <ul> <li>Replaced the last classification layer to adapt the model for binary classification.</li> <li>Applied <strong>temperature scaling</strong> to calibrate the model’s predictions.</li> </ul> <div style="display: flex; justify-content: center;"> <table style="border-collapse: collapse; width: 50%; text-align: center;"> <thead> <tr> <th style="border: 1px solid #ddd; padding: 8px;">Model Name</th> <th style="border: 1px solid #ddd; padding: 8px;">Layers</th> <th style="border: 1px solid #ddd; padding: 8px;">Parameters</th> </tr> </thead> <tbody> <tr> <td style="border: 1px solid #ddd; padding: 8px;">DenseNet-121</td> <td style="border: 1px solid #ddd; padding: 8px;">121</td> <td style="border: 1px solid #ddd; padding: 8px;">~7 million</td> </tr> </tbody> </table> </div> <hr> <h2 id="calibration-techniques">Calibration Techniques</h2> <p>The project focuses on improving model calibration using <strong>temperature scaling</strong>, a post-processing method that adjusts the predicted probabilities by a temperature parameter <code class="language-plaintext highlighter-rouge">T</code>. Lowering or increasing this parameter helps to <strong>smooth the probabilities</strong> and <strong>reduce calibration errors</strong>.</p> <h4 id="steps-to-apply-temperature-scaling">Steps to Apply Temperature Scaling:</h4> <ol> <li>Train the model and obtain logits.</li> <li>Adjust the logits with a temperature parameter.</li> <li>Recalculate the probabilities and evaluate the <strong>Expected Calibration Error (ECE)</strong>.</li> </ol> <hr> <h2 id="results">Results</h2> <p>The project shows a clear improvement in model calibration after applying temperature scaling.</p> <h3 id="reliability-diagram-comparison">Reliability Diagram Comparison</h3> <p>Below are the <strong>reliability diagrams</strong> comparing the initial model predictions and the calibrated predictions using the optimal temperature factor for both models.</p> <div class="row justify-content-sm-center"> <div class="col-md-6 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/reliability_diagram_LENET-480.webp 480w,/assets/img/reliability_diagram_LENET-800.webp 800w,/assets/img/reliability_diagram_LENET-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/reliability_diagram_LENET.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="LeNet-5: Reliability Diagram Before and After Temperature Scaling" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-md-6 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/reliability_diagram_DENSE-480.webp 480w,/assets/img/reliability_diagram_DENSE-800.webp 800w,/assets/img/reliability_diagram_DENSE-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/reliability_diagram_DENSE.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="DenseNet-121: Reliability Diagram Before and After Temperature Scaling" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>The reliability diagram highlights the difference between the predicted probabilities and actual outcomes. The red line shows the calibrated model, which significantly reduces the calibration error compared to the initial predictions highlighted in blue.</p> <hr> <h2 id="dataset">Dataset</h2> <p>The project uses a filtered version of the <strong>CIFAR-10 dataset</strong>, containing images of <strong>birds</strong> and <strong>cats</strong>. The dataset is preprocessed to include only these two categories, and the images are normalized for training.</p> <div style="display: flex; justify-content: center;"> <table style="border-collapse: collapse; width: 30%; text-align: center;"> <thead> <tr> <th style="border: 1px solid #ddd; padding: 8px;">Class</th> <th style="border: 1px solid #ddd; padding: 8px;">Label</th> </tr> </thead> <tbody> <tr> <td style="border: 1px solid #ddd; padding: 8px;">Bird</td> <td style="border: 1px solid #ddd; padding: 8px;">0</td> </tr> <tr> <td style="border: 1px solid #ddd; padding: 8px;">Cat</td> <td style="border: 1px solid #ddd; padding: 8px;">1</td> </tr> </tbody> </table> </div> <p>The dataset can be downloaded from the following link:</p> <ul> <li><a href="https://www.cs.toronto.edu/~kriz/cifar.html" rel="external nofollow noopener" target="_blank">CIFAR-10 Dataset</a></li> </ul> <hr> <p>This project was carried out in collaboration with <a href="https://www.linkedin.com/in/elena-almagro-azor-a06942217/" rel="external nofollow noopener" target="_blank">Elena Almagro</a> and <a href="https://www.linkedin.com/in/juan-munoz-villalon/" rel="external nofollow noopener" target="_blank">Juan Muñoz</a>.</p> <hr> <h2 id="full-report">Full Report</h2> <p>You can download the complete report document via the following link:</p> <p><a href="/assets/pdf/CNN_calibration.pdf">Download Full Report PDF</a></p> <hr> <h2 id="github-repository">GitHub Repository</h2> <p>You can find the Python notebook for this project, with its results and the whole process on <a href="https://github.com/mariogolbano/CNNs_calibration" rel="external nofollow noopener" target="_blank">GitHub</a></p> </article> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2025 Mario Golbano Corzo. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-586TP9MY1P"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-586TP9MY1P");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> </body> </html>